<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="dcterms.date" content="2023-01-01" />
  <meta name="keywords" content="–ª–µ–∫—Ü–∏–∏, –º—Ñ—Ç–∏, –º–µ—â–µ—Ä–∏–Ω, –º–µ—â–µ—Ä–∏–Ω
–∏–ª—å—è, —Ç–µ—Ö, —Ç–µ—Ö–∞—Ç—å, 1 –∫—É—Ä—Å" />
  <title>–°++</title>
  <link rel="stylesheet" href="styles.css">
<link href="prism-monokai.css" rel="stylesheet">
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500&display=swap" rel="stylesheet">
<!--<link rel="stylesheet" type="text/css" href="https://jsxgraph.org/distrib/jsxgraph.css" />
 <script type="text/javascript" src="https://jsxgraph.org/distrib/jsxgraphcore.js"></script>-->
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<header id="title-block-header">
<h1 class="title">–°++</h1>
<p class="date">2023</p>
</header>
<details>
<summary>–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</summary>
<nav id="TOC" role="doc-toc">
<ul>
<li><a href="#–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º-–∏-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏"
id="toc-–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º-–∏-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏">–ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ
—Ñ—É–Ω–∫—Ü–∏–∏</a>
<ul>
<li><a href="#–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏"
id="toc-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏">–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</a></li>
<li><a href="#override" id="toc-override"><code class="language-cpp">override</code></a></li>
<li><a href="#final" id="toc-final"><code class="language-cpp">final</code></a></li>
<li><a href="#–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º" id="toc-–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º">–ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º</a></li>
<li><a href="#–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ-–∫–ª–∞—Å—Å—ã-–∏-—á–∏—Å—Ç—ã–µ-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-–º–µ—Ç–æ–¥—ã"
id="toc-–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ-–∫–ª–∞—Å—Å—ã-–∏-—á–∏—Å—Ç—ã–µ-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-–º–µ—Ç–æ–¥—ã">–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ
–∫–ª–∞—Å—Å—ã –∏ ¬´—á–∏—Å—Ç—ã–µ¬ª –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã </a>
<ul>
<li><a href="#—Å–∏–Ω—Ç–∞–∫—Å–∏—Å-—á–∏—Å—Ç–æ–≥–æ-–≤–∏—Ä—Ç–∞–ª—å–Ω–æ–≥–æ-–º–µ—Ç–æ–¥–∞"
id="toc-—Å–∏–Ω—Ç–∞–∫—Å–∏—Å-—á–∏—Å—Ç–æ–≥–æ-–≤–∏—Ä—Ç–∞–ª—å–Ω–æ–≥–æ-–º–µ—Ç–æ–¥–∞">–°–∏–Ω—Ç–∞–∫—Å–∏—Å —á–∏—Å—Ç–æ–≥–æ
–≤–∏—Ä—Ç–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ üòé</a></li>
</ul></li>
<li><a href="#–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π-–¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä"
id="toc-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π-–¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä">–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä</a></li>
<li><a href="#rtti-and-dynamic-cast" id="toc-rtti-and-dynamic-cast">RTTI
and dynamic cast </a></li>
<li><a href="#dynamic_cast" id="toc-dynamic_cast"><code class="language-cpp">dynamic_cast</code></a></li>
<li><a href="#–æ–ø–µ—Ä–∞—Ç–æ—Ä-typeid" id="toc-–æ–ø–µ—Ä–∞—Ç–æ—Ä-typeid">–û–ø–µ—Ä–∞—Ç–æ—Ä <code class="language-cpp">typeid</code></a></li>
<li><a href="#—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ-–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö-–æ–±—ä–µ–∫—Ç–æ–≤-–∏-vtables"
id="toc-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ-–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö-–æ–±—ä–µ–∫—Ç–æ–≤-–∏-vtables">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ vtables </a></li>
</ul></li>
</ul>
</nav>
</details>
<h1 id="–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º-–∏-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏">–ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ
—Ñ—É–Ω–∫—Ü–∏–∏</h1>
<hr />
<h2 id="–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-—Ñ—É–Ω–∫—Ü–∏–∏">–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏</h2>
<blockquote>
<p>–û—Ç —Ç–æ–≥–æ –∫–∞–∫ —è –Ω–∞–∑—ã–≤–∞—é –æ–±—ä–µ–∫—Ç –∑–∞–≤–∏—Å–∏—Ç —Ç–æ, –∫–∞–∫ —è –ø–æ–Ω–∏–º–∞—é –æ–ø–µ—Ä–∞—Ü–∏–∏ –Ω–∞–¥
–Ω–∏–º.</p>
<p>(—Å)</p>
</blockquote>
<p><img src="img/polymorhism.png" /></p>
<blockquote>
<p>–ü—É—Å—Ç—å –µ—Å—Ç—å –∫–Ω–∏–≥–∞ —Ä–µ—Ü–µ–ø—Ç–æ–≤ –∏ –≤ –Ω–µ–π –≤ –Ω–∞—á–∞–ª–µ —Ä–∞–∑–¥–µ–ª–∞ –ø—Ä–æ –∫—Ä—É–ø—ã –Ω–∞–ø–∏—Å–∞–Ω–æ
–∫–∞–∫ –≤–∞—Ä–∏—Ç—å –∫—Ä—É–ø—É –≤ –æ–±—â–µ–º –≤–∏–¥–µ, –∞ –ø–æ—Ç–æ–º –æ—Ç–¥–µ–ª—å–Ω–æ –Ω–∞–ø–∏—Å–∞–Ω–æ –∫–∞–∫ –≤–∞—Ä–∏—Ç—å
–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∫—Ä—É–ø—ã, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≥—Ä–µ—á–∫—É. –í–∞–º –¥–∞—é—Ç –ø–∞—á–∫—É –≥—Ä–µ—á–∫–∏ –∏ –≥–æ–≤–æ—Ä—è—Ç:
‚Äú–°–≤–∞—Ä–∏—Ç–µ –∫—Ä—É–ø—É.‚Äù</p>
<p>–ß—Ç–æ –≤—ã –¥–µ–ª–∞–µ—Ç–µ? –°–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –µ—Å–ª–∏ –≤—ã –Ω–µ —Å–æ–≤—Å–µ–º –¥–æ–ª–≥–æ –∏–∑—É—á–∞–ª–∏ C++ –∏
–µ—â–µ –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ—Ç–µ—Ä—è–ª–∏ –∑–¥—Ä–∞–≤—ã–π —Ä–∞—Å—Å—É–¥–æ–∫, –≤—ã –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤–∏—Ç—å –≥—Ä–µ—á–∫—É –ø–æ
—Ä–µ—Ü–µ–ø—Ç—É –≥—Ä–µ—á–∫–∏.</p>
</blockquote>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    void f() {
        std::cout &lt;&lt; &quot;—è –≤–∞—Ä—é –∫—Ä—É–ø—É\n&quot;;
    }
};

struct Derived: public Base {
    void f() {
        std::cout &lt;&lt; &quot;—è –≤–∞—Ä—é –≥—Ä–µ—á–∫—É\n&quot;;
    }
};

int main() {
    Base b;
    Derived d;
    Base&amp; b_ = d;

    b.f(); // –æ—á–µ–≤–∏–¥–Ω–æ
    d.f(); // –æ—á–µ–≤–∏–¥–Ω–æ

    // –ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç?

    b_.f();

    // –≤—ã–≤–µ–¥–µ—Ç &quot;—è –≤–∞—Ä—é –∫—Ä—É–ø—É\n&quot;;
}</code></pre>
<p>–ß—Ç–æ–±—ã –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ —Ä–æ–¥–∏—Ç–µ–ª—è <strong>–ø–æ —Å—Å—ã–ª–∫–µ</strong> –æ—Ç
–æ–±—ä–µ–∫—Ç–∞ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –º–µ—Ç–æ–¥ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞, –∞ –Ω–µ —Ä–æ–¥–∏—Ç–µ–ª—è, –Ω—É–∂–Ω–æ
–Ω–∞–ø–∏—Å–∞—Ç—å –ø–µ—Ä–µ–¥ –º–µ—Ç–æ–¥–æ–º —Ä–æ–¥–∏—Ç–µ–ª—è <code class="language-cpp">virtual</code>.</p>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    virtual void f() {
        std::cout &lt;&lt; &quot;—è –≤–∞—Ä—é –∫—Ä—É–ø—É\n&quot;;
    }
};

struct Derived: public Base {
    void f() {
        std::cout &lt;&lt; &quot;—è –≤–∞—Ä—é –≥—Ä–µ—á–∫—É\n&quot;;
    }
};

int main() {
    Base b;
    Derived d;
    Base&amp; b_ = d;

    b.f(); // –æ—á–µ–≤–∏–¥–Ω–æ
    d.f(); // –æ—á–µ–≤–∏–¥–Ω–æ

    // –ß—Ç–æ –≤—ã–≤–µ–¥–µ—Ç?

    b_.f();

    // –≤—ã–≤–µ–¥–µ—Ç &quot;—è –≤–∞—Ä—é –≥—Ä–µ—á–∫—É\n&quot;
}</code></pre>
<h2 id="override"><code class="language-cpp">override</code></h2>
<hr />
<p>–ü–∏—à–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞, –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Ñ–∏–≥—É—Ä–Ω–æ–π
—Å–∫–æ–±–∫–æ–π.</p>
<p>–≠—Ç–æ —Å–ª–æ–≤–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã —è–≤–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å, —á—Ç–æ –≤—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç–µ
–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥.</p>
<h2 id="final"><code class="language-cpp">final</code></h2>
<hr />
<p>–ü–∏—à–µ—Ç—Å—è –ø–æ—Å–ª–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–∞, –ø–µ—Ä–µ–¥ –æ—Ç–∫—Ä—ã–≤–∞—é—â–µ–π —Ñ–∏–≥—É—Ä–Ω–æ–π
—Å–∫–æ–±–∫–æ–π.</p>
<p>–≠—Ç–æ —Å–ª–æ–≤–æ –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –¥–∞–Ω–Ω—ã–π
–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥.</p>
<h2 id="–ø–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º">–ü–æ–ª–∏–º–æ—Ä—Ñ–∏–∑–º</h2>
<hr />
<blockquote>
<p>–ß—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ? –ü–µ—Å–Ω—è –≥—Ä—É–ø–ø—ã ¬´–ù–∞—É—á–Ω–æ-—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Ä—ç–ø¬ª <a href="#fn1"
class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
</blockquote>
<p>–≠—Ç–æ —Ç–æ —á—Ç–æ –¥–∞—é—Ç –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π
–ø—Ä–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏—è—Ö.</p>
<h2 id="–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ-–∫–ª–∞—Å—Å—ã-–∏-—á–∏—Å—Ç—ã–µ-–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ-–º–µ—Ç–æ–¥—ã">–ê–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ
–∫–ª–∞—Å—Å—ã –∏ ¬´—á–∏—Å—Ç—ã–µ¬ª –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã <a href="#fn2" class="footnote-ref"
id="fnref2" role="doc-noteref"><sup>2</sup></a></h2>
<hr />
<p><strong>Pure virtual method</strong> - —ç—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å,
–∫–æ—Ç–æ—Ä—ã–π –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –Ω–µ –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω <a
href="#fn3" class="footnote-ref" id="fnref3"
role="doc-noteref"><sup>3</sup></a> –≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∫–ª–∞—Å—Å–µ, –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å
–æ–ø—Ä–µ–¥–µ–ª–µ–Ω –≤ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫–∞—Ö.</p>
<h3 id="—Å–∏–Ω—Ç–∞–∫—Å–∏—Å-—á–∏—Å—Ç–æ–≥–æ-–≤–∏—Ä—Ç–∞–ª—å–Ω–æ–≥–æ-–º–µ—Ç–æ–¥–∞">–°–∏–Ω—Ç–∞–∫—Å–∏—Å —á–∏—Å—Ç–æ–≥–æ
–≤–∏—Ä—Ç–∞–ª—å–Ω–æ–≥–æ –º–µ—Ç–æ–¥–∞ üòé</h3>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

class Shape {
public:
    virtual double area() = 0; // –µ—Å–ª–∏ –Ω–∞–ø–∏—Å–∞—Ç—å = 0, —Ç–æ –º–µ—Ç–æ–¥ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è
                               // pyre virtual method 
};

int main() {
    //Shape s; // –æ—à–∏–±–∫–∞, —Ç.–∫. –æ–±—ä–µ–∫—Ç—ã –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–ª—å–∑—è
}</code></pre>
<p>–ï—Å–ª–∏ –≤ –∫–ª–∞—Å—Å–µ –µ—Å—Ç—å —á–∏—Å—Ç—ã–π –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥, —Ç–æ –∫–ª–∞—Å—Å
<strong>–∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–π</strong>.</p>
<p>–û–±—ä–µ–∫—Ç—ã –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å–æ–∑–¥–∞–≤–∞—Ç—å –Ω–µ–ª—å–∑—è.</p>
<p>–û–±—è–∑–∞–Ω –ª–∏ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫ —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å pure virtual method?</p>
<p>–ù–µ—Ç, –Ω–µ –æ–±—è–∑–∞–Ω, –Ω–æ –µ—Å–ª–∏ —Ç–∞–∫–æ–π –º–µ—Ç–æ–¥ –Ω–µ —Ä–µ–∞–ª–∏–∑–≤–∞–Ω, —Ç–æ –Ω–∞—Å–ª–µ–¥–Ω–∏–∫ —Å–∞–º
—è–≤–ª—è–µ—Ç—Å—è –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–º –∫–ª–∞—Å—Å–æ–º, –∏ –Ω–µ–ª—å–∑—è —Å–æ–∑–¥–∞–≤–∞—Ç—å —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –∫–ª–∞—Å—Å–∞.</p>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

class Shape {
public:
    virtual double area() const = 0;
};

// –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å pure virtual method
double Shape::area() const {
    std::cout &lt;&lt; &quot;shape area\n&quot;;
}

class Square: public Shape {
public:
    virtual double area() const override {
        std::cout &lt;&lt; &quot;square area\n&quot;;
    }
};

int main() {
    Square s;
    s.area();

    Shape&amp; s_ = s;

    s_.area(); // –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞ Square
}</code></pre>
<h2 id="–≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π-–¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä">–í–∏—Ä—Ç—É–∞–ª—å–Ω—ã–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä</h2>
<hr />
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    int* b = new int();
    ~Base() {
        delete b;
        std::cout &lt;&lt; &quot;Base destructor\n&quot;;
    }
};

struct Derived: public Base {
    int* d = new int();
    ~Derived() {
        delete d;
        std::cout &lt;&lt; &quot;Derived destructor\n&quot;;
    }
};

int main() {
    Base* b = new Derived();
    delete b; // –∫–∞–∫–æ–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω?
    // —Ç–æ–ª—å–∫–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä Base, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ—Ç —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏
}</code></pre>
<p>–ü–æ—ç—Ç–æ–º—É –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä —Ç–æ–∂–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–º.</p>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    int* b = new int();
    virtual ~Base() {
        delete b;
        std::cout &lt;&lt; &quot;Base destructor\n&quot;;
    }
};

struct Derived: public Base {
    int* d = new int();
    ~Derived() {
        delete d;
        std::cout &lt;&lt; &quot;Derived destructor\n&quot;;
    }
};

int main() {
    Base* b = new Derived();
    delete b; // –∫–∞–∫–æ–π –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω?
    // —Ç–æ–ª—å–∫–æ –¥–µ—Å—Ç—Ä—É–∫—Ç–æ—Ä Base, –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ—Ç —É—Ç–µ—á–∫–∞ –ø–∞–º—è—Ç–∏
}</code></pre>
<h2 id="rtti-and-dynamic-cast">RTTI and dynamic cast <a href="#fn4"
class="footnote-ref" id="fnref4"
role="doc-noteref"><sup>4</sup></a></h2>
<hr />
<p>–¢–∏–ø <strong>–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–π</strong>, –µ—Å–ª–∏ –≤ –Ω–µ–º –µ—Å—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω–∞
–≤–∏—Ä—Ç–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è.</p>
<p>–ù–æ —á—Ç–æ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç –¥–ª—è –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä–∞?</p>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    virtual ~Base() {}
    virtual void f() {
        std::cout &lt;&lt; &quot;base f\n&quot;;
    }
};

struct Derived: public Base {
    void f() override {
        std::cout &lt;&lt; &quot;derived f\n&quot;;
    }
};

int main() {
    int x;
    std::cin &gt;&gt; x;

    Base b;
    Derived d;

    // –≤ –º–æ–º–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫—É—é –≤–∏—Ä—Ç–∞–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
    Base&amp; b_ = x &gt; 0 ? b : d;

    b_.f();
}</code></pre>
<p>–ö–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤—ã–Ω—É–∂–¥–µ–Ω –¥–æ–ø–æ–ª–Ω—è—Ç—å –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ —Ç–∏–ø—ã –Ω–µ–∫–æ—Ç–æ—Ä—ã–º –ø–æ–ª–µ–º,
–∫–æ—Ç–æ—Ä–æ–µ –≤ runtime –ø–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å –∫–∞–∫–æ–π —Ç–∏–ø –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ. –≠—Ç–æ –∏ –µ—Å—Ç—å
<strong>RTTI</strong>.</p>
<h2 id="dynamic_cast"><code class="language-cpp">dynamic_cast</code></h2>
<hr />
<p><code class="language-cpp">dynamic_cast</code> –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã–µ
—Ç–∏–ø—ã –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É.</p>
<p>–ß—Ç–æ –æ–Ω –¥–µ–ª–∞–µ—Ç?</p>
<ol type="1">
<li>–í–æ –≤—Ä–µ–º—è –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ —Ç–∏–ø—ã –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –º–æ–∂–Ω–æ –ª–∏
—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –∏—Ö –¥—Ä—É–≥ –∫ –¥—Ä—É–≥—É (–ª–µ–∂–∞—Ç –ª–∏ –æ–Ω–∏ –≤ –æ–¥–Ω–æ–º –∏ —Ç–æ–º –∂–µ
–≥—Ä–∞—Ñ–µ –Ω–∞—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è).</li>
<li>–í –º–æ–º–µ–Ω—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ RTTI –∏ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –º–æ–∂–Ω–æ –ª–∏
–∫–∞—Å—Ç–æ–≤–∞—Ç—å.</li>
</ol>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Granny {
    virtual void f() {}
};

struct Mother: public Granny {
};

struct Father: public Granny {
};

struct Son: public Mother, public Father {
};

int main() {
    Mother* m = new Son();

    std::cout &lt;&lt; dynamic_cast&lt;Father*&gt;(m); // –≤—Å–µ –æ–∫
    // –µ—Å–ª–∏ –ø—Ä–∏–≤–µ—Å—Ç–∏ –Ω–µ–ª—å–∑—è, —Ç–æ –≤–µ—Ä–Ω–µ—Ç nullptr

    delete m;
}</code></pre>
<h2 id="–æ–ø–µ—Ä–∞—Ç–æ—Ä-typeid">–û–ø–µ—Ä–∞—Ç–æ—Ä <code class="language-cpp">typeid</code></h2>
<hr />
<p>–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç <code class="language-cpp">std::typeinfo</code>.</p>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;
#include &lt;typeinfo&gt;

struct Granny {
    virtual void f() {}
};

struct Mother: public Granny {
};

struct Father: public Granny {
};

struct Son: public Mother, public Father {
};

int main() {
    Son s;

    Mother&amp; m_ = s;

    std::cout &lt;&lt; (typeid(m_) == typeid(s)) &lt;&lt; &quot;\n&quot;;

    Mother m;
    std::cout &lt;&lt; (typeid(m) == typeid(s)) &lt;&lt; &quot;\n&quot;;

    std::cout &lt;&lt; typeid(m).name() &lt;&lt; &quot;\n&quot;;
}</code></pre>
<p><code class="language-cpp">typeid</code> - –Ω—É–∂–µ–Ω –æ—á–µ–Ω—å —Ä–µ–¥–∫–æ.</p>
<h2 id="—É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ-–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö-–æ–±—ä–µ–∫—Ç–æ–≤-–∏-vtables">–£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
–ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ –∏ vtables <a href="#fn5" class="footnote-ref"
id="fnref5" role="doc-noteref"><sup>5</sup></a></h2>
<hr />
<p>–ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ –≤ –ø–∞–º—è—Ç—å –∫–ª–∞–¥–µ—Ç—Å—è —É–∫–∞–∑–∞—Ç–µ–ª—å <code class="language-cpp">vptr</code> –Ω–∞ –æ–±–ª–∞—Å—Ç—å –≤ —Å—Ç–∞—Ç–∏—á–µ–∫–æ–π –ø–∞–º—è—Ç–∏, –≥–¥–µ –ª–µ–∂–∏—Ç <code class="language-cpp">vtable</code> (—Ç–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –æ —Ç–∏–ø–µ –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã—Ö
—Ñ—É–Ω–∫—Ü–∏—è—Ö). –≠—Ç–∏—Ö —Ç–∞–±–ª–∏—Ü —Å—Ç–æ–ª—å–∫–æ –∂–µ —Å–∫–æ–ª—å–∫–æ –ø–æ–ª–∏–º–æ—Ä—Ñ–Ω—ã—Ö —Ç–∏–ø–æ–≤.</p>
<div style="display: flex; flex-direction: row;">
<div>
<pre class="language-cpp"><code class="language-cpp">#include &lt;iostream&gt;

struct Base {
    virtual void f() { 
        std::cout &lt;&lt; &quot;base f\n&quot;;
    }
    void foo() {}
    int b;
};

struct Derived: public Base {
    void f() {
        std::cout &lt;&lt; &quot;derived f\n&quot;;
    }
    virtual void g() {}
    int d;
};

int main() {
    Derived d;
    Base&amp; b = d;
    // –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø–æ —Å—Å—ã–ª–∫–µ
    // –±–µ—Ä–µ—Ç—Å—è —á–∞—Å—Ç—å vtable
    // –¥–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π d

    // –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ—Ç –≤—ã–∑–≤–∞–Ω 
    // –º–µ—Ç–æ–¥ –∫–ª–∞—Å—Å–∞ derived
    b.f();
}</code></pre>
</div>
<div style="width: 50%;">
<p><img src="img/vtable.png" /></p>
</div>
</div>
<p>–ê –≥–¥–µ —Ñ—É–Ω–∫—Ü–∏—è <code class="language-cpp">foo</code>?</p>
<p>–ï–µ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –∫–æ–º–ø–∏–ª—è—Ç–æ—Ä –≤ –º–æ–º–µ–Ω—Ç –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∑–Ω–∞–µ—Ç
–∫–∞–∫–æ–π –∫–æ–¥ –Ω–∞–¥–æ –≤—ã–ø–æ–ª–Ω–∏—Ç—å, –∞ —Å –≤–∏—Ä—Ç–∞–ª—å–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –Ω–µ —Ç–∞–∫.</p>
<section id="footnotes" class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1"><p><a
href="https://www.youtube.com/watch?v=pmxBTAv9sb4">—Å—Å—ã–ª—å</a><a
href="#fnref1" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn2"><p>Abstract classes and pure virtual methods<a
href="#fnref2" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn3"><p>–°–∫–æ—Ä–µ–µ –Ω–µ –∞–∫—Ç—É–∞–ª–µ–Ω, —Ç.–∫. –µ–≥–æ –º–æ–∂–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å.<a
href="#fnref3" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn4"><p>Run-Time Type Information<a href="#fnref4"
class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
<li id="fn5"><p>Vtables and layouts of polymorhic objects<a
href="#fnref5" class="footnote-back" role="doc-backlink">‚Ü©Ô∏é</a></p></li>
</ol>
</section>
<script src="prism.js"></script>
<script src="copy_code.js"></script>
</body>
</html>
